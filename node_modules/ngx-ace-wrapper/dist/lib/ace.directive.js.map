{"version":3,"file":"ace.directive.js","sourceRoot":"","sources":["../../src/lib/ace.directive.ts"],"names":[],"mappings":"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","sourcesContent":["import * as ace from 'brace';\n\nimport { Directive, Optional, Inject,\n  OnInit, DoCheck, OnDestroy, OnChanges,\n  Input, Output, EventEmitter, NgZone, ElementRef,\n  KeyValueDiffer, KeyValueDiffers, SimpleChanges } from '@angular/core';\n\nimport { ACE_CONFIG, AceConfig, AceConfigInterface,\n  AceEditorEvent, AceEditorEvents, AceSelectionEvent, AceSelectionEvents } from './ace.interfaces';\n\n@Directive({\n  selector: '[ace]',\n  exportAs: 'ngxAce'\n})\nexport class AceDirective implements OnInit, DoCheck, OnDestroy, OnChanges {\n  private instance: ace.Editor | null = null;\n\n  private configDiff: KeyValueDiffer<string, any> | null = null;\n\n  @Input() disabled: boolean = false;\n\n  @Input('ace') config?: AceConfigInterface;\n\n  @Output() blur: EventEmitter<any> = new EventEmitter<any>();\n  @Output() focus: EventEmitter<any> = new EventEmitter<any>();\n\n  @Output() copy: EventEmitter<any> = new EventEmitter<any>();\n  @Output() paste: EventEmitter<any> = new EventEmitter<any>();\n\n  @Output() change: EventEmitter<any> = new EventEmitter<any>();\n\n  @Output() changeCursor: EventEmitter<any> = new EventEmitter<any>();\n  @Output() changeSession: EventEmitter<any> = new EventEmitter<any>();\n  @Output() changeSelection: EventEmitter<any> = new EventEmitter<any>();\n\n  constructor(private zone: NgZone,\n    private elementRef: ElementRef, private differs: KeyValueDiffers,\n    @Optional() @Inject(ACE_CONFIG) private defaults: AceConfigInterface) {}\n\n  ngOnInit(): void {\n    const params = new AceConfig(this.defaults);\n\n    params.assign(this.config); // Custom configuration\n\n    if (this.disabled) {\n      params.readOnly = true;\n\n      params.highlightActiveLine = false;\n    }\n\n    params.mode = 'ace/mode/' + (params.mode || 'text');\n    params.theme = 'ace/theme/' + (params.theme || 'github');\n\n    this.zone.runOutsideAngular(() => {\n      this.instance = ace.edit(this.elementRef.nativeElement);\n\n      this.instance.$blockScrolling = Infinity;\n\n      this.instance.setOptions(params);\n    });\n\n    // Add native Ace event handling\n    AceEditorEvents.forEach((eventName: AceEditorEvent) => {\n      if (this.instance) {\n        this.instance.on(eventName, (...args: any[]) => {\n          if (args.length === 1) {\n            args = args[0];\n          }\n\n          if (this[eventName]) {\n            this.zone.run(() => {\n              if (this[eventName].observers.length) {\n                this[eventName].emit(args);\n              }\n            });\n          }\n        });\n      }\n    });\n\n    // Add native Ace selection event handling\n    AceSelectionEvents.forEach((eventName: AceSelectionEvent) => {\n      if (this.instance) {\n        this.instance.selection.on(eventName, (...args: any[]) => {\n          if (args.length === 1) {\n            args = args[0];\n          }\n\n          if (this[eventName]) {\n            if (this[eventName].observers.length) {\n              this[eventName].emit(args);\n            }\n          }\n        });\n      }\n    });\n\n    if (!this.configDiff) {\n      this.configDiff = this.differs.find(this.config || {}).create();\n\n      this.configDiff.diff(this.config || {});\n    }\n  }\n\n  ngDoCheck(): void {\n    if (this.configDiff) {\n      const changes = this.configDiff.diff(this.config || {});\n\n      if (changes) {\n        this.ngOnDestroy();\n\n        this.ngOnInit();\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.instance) {\n      if (this.instance.isFocused() as any as boolean) {\n        this.blur.emit();\n      }\n\n      delete this.instance;\n\n      this.instance = null;\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['disabled']) {\n      if (changes['disabled'].currentValue !== changes['disabled'].previousValue) {\n        this.zone.runOutsideAngular(() => {\n          if (this.instance) {\n            const params = new AceConfig(this.defaults);\n\n            params.assign(this.config); // Custom configuration\n\n            this.instance.clearSelection();\n\n            const hlActive = (params.highlightActiveLine == null) ? true : false;\n\n            this.instance.setHighlightActiveLine(this.disabled ? false : hlActive);\n\n            this.instance.setReadOnly(this.disabled ? true : (params.readOnly ||Â false));\n          }\n        });\n      }\n    }\n  }\n\n  public ace(): ace.Editor | null {\n    return this.instance;\n  }\n\n  public clear(): void {\n    if (this.instance) {\n      this.instance.setValue('');\n\n      this.instance.clearSelection();\n    }\n  }\n\n  public getValue(): string | undefined {\n    if (this.instance) {\n      return this.instance.getValue();\n    }\n  }\n\n  public setValue(value: string, cursorPos?: -1 | 1): void {\n    if (this.instance) {\n      this.instance.setValue(value || '', cursorPos);\n    }\n  }\n}\n"]}