(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('@angular/common/http'), require('@angular/platform-browser'), require('rxjs'), require('@angular/common')) :
    typeof define === 'function' && define.amd ? define('@ngstack/translate', ['exports', '@angular/core', '@angular/common/http', '@angular/platform-browser', 'rxjs', '@angular/common'], factory) :
    (factory((global.ngstack = global.ngstack || {}, global.ngstack.translate = {}),global.ng.core,global.ng.common.http,global.ng.platformBrowser,global.rxjs,global.ng.common));
}(this, (function (exports,i0,i1,i1$1,rxjs,common) { 'use strict';

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    var __assign = function () {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s)
                    if (Object.prototype.hasOwnProperty.call(s, p))
                        t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __awaiter(thisArg, _arguments, P, generator) {
        return new (P || (P = Promise))(function (resolve, reject) {
            function fulfilled(value) { try {
                step(generator.next(value));
            }
            catch (e) {
                reject(e);
            } }
            function rejected(value) { try {
                step(generator["throw"](value));
            }
            catch (e) {
                reject(e);
            } }
            function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
            step((generator = generator.apply(thisArg, _arguments || [])).next());
        });
    }
    function __generator(thisArg, body) {
        var _ = { label: 0, sent: function () { if (t[0] & 1)
                throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
        return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function () { return this; }), g;
        function verb(n) { return function (v) { return step([n, v]); }; }
        function step(op) {
            if (f)
                throw new TypeError("Generator is already executing.");
            while (_)
                try {
                    if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done)
                        return t;
                    if (y = 0, t)
                        op = [op[0] & 2, t.value];
                    switch (op[0]) {
                        case 0:
                        case 1:
                            t = op;
                            break;
                        case 4:
                            _.label++;
                            return { value: op[1], done: false };
                        case 5:
                            _.label++;
                            y = op[1];
                            op = [0];
                            continue;
                        case 7:
                            op = _.ops.pop();
                            _.trys.pop();
                            continue;
                        default:
                            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                                _ = 0;
                                continue;
                            }
                            if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) {
                                _.label = op[1];
                                break;
                            }
                            if (op[0] === 6 && _.label < t[1]) {
                                _.label = t[1];
                                t = op;
                                break;
                            }
                            if (t && _.label < t[2]) {
                                _.label = t[2];
                                _.ops.push(op);
                                break;
                            }
                            if (t[2])
                                _.ops.pop();
                            _.trys.pop();
                            continue;
                    }
                    op = body.call(thisArg, _);
                }
                catch (e) {
                    op = [6, e];
                    y = 0;
                }
                finally {
                    f = t = 0;
                }
            if (op[0] & 5)
                throw op[1];
            return { value: op[0] ? op[1] : void 0, done: true };
        }
    }
    function __values(o) {
        var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
        if (m)
            return m.call(o);
        return {
            next: function () {
                if (o && i >= o.length)
                    o = void 0;
                return { value: o && o[i++], done: !o };
            }
        };
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m)
            return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done)
                ar.push(r.value);
        }
        catch (error) {
            e = { error: error };
        }
        finally {
            try {
                if (r && !r.done && (m = i["return"]))
                    m.call(i);
            }
            finally {
                if (e)
                    throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++)
            ar = ar.concat(__read(arguments[i]));
        return ar;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var TRANSLATE_SETTINGS = new i0.InjectionToken('TRANSLATE_SETTINGS');
    var TranslateService = /** @class */ (function () {
        function TranslateService(http, settings) {
            this.http = http;
            this.data = {};
            this._fallbackLang = 'en';
            this._translationRoot = 'assets/i18n';
            /**
             * Raised each time active language gets changed.
             */
            this.activeLangChanged = new i0.EventEmitter();
            /**
             * Toggles debug mode.
             *
             * When in the debug mode, the service automatically prepends active language id to very translated result.
             * That allows to verify that your components support i18n correctly and do not contain hard-coded text.
             */
            this.debugMode = false;
            /**
             * Disable caching and always download language files.
             *
             * Applies cache busting query parameters to urls, for example: '?v=1522426955882'.
             */
            this.disableCache = false;
            /**
             * List of supported languages.
             *
             * The service will attempt to load resource files only for given set of languages,
             * and will automatically use fallback language for all unspecified values.
             *
             * By default this property is empty and service is going to probe all language files.
             * Active and Fallback languages are always taken into account even if you do not specify them in the list.
             */
            this.supportedLangs = [];
            /**
             * List of extra paths to look for translation files.
             *
             * By default this property is empty.
             * The value of `translationRoot` property is always taken into account.
             */
            this.translatePaths = [];
            this.applySettings(settings);
        }
        Object.defineProperty(TranslateService.prototype, "fallbackLang", {
            /**
             * The fallback language to use when a resource string for the active language is not available.
             */
            get: /**
             * The fallback language to use when a resource string for the active language is not available.
             * @return {?}
             */ function () {
                return this._fallbackLang;
            },
            set: /**
             * @param {?} value
             * @return {?}
             */ function (value) {
                this._fallbackLang = value || 'en';
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TranslateService.prototype, "activeLang", {
            /**
             * The language to use for the translations.
             */
            get: /**
             * The language to use for the translations.
             * @return {?}
             */ function () {
                return this._activeLang;
            },
            set: /**
             * @param {?} value
             * @return {?}
             */ function (value) {
                var _this = this;
                /** @type {?} */
                var previousValue = this._activeLang;
                /** @type {?} */
                var newValue = value || this.fallbackLang;
                /** @type {?} */
                var changed = newValue !== previousValue;
                if (changed) {
                    this._activeLang = newValue;
                    this.use(newValue).then(function () {
                        _this.activeLangChanged.next({
                            previousValue: previousValue,
                            currentValue: newValue
                        });
                    });
                }
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @return {?}
         */
        TranslateService.prototype.getBrowserLanguage = /**
         * @return {?}
         */
            function () {
                var _a = __read(navigator.language
                    .replace('-', '_')
                    .toLowerCase()
                    .split('_'), 1), lang = _a[0] /*, locale*/;
                return lang;
            };
        Object.defineProperty(TranslateService.prototype, "translationRoot", {
            /**
             * The root path to use when loading default translation files.
             * Defaults to 'assets/i18n'.
             */
            get: /**
             * The root path to use when loading default translation files.
             * Defaults to 'assets/i18n'.
             * @return {?}
             */ function () {
                return this._translationRoot;
            },
            set: /**
             * @param {?} value
             * @return {?}
             */ function (value) {
                this._translationRoot = value || 'assets/i18n';
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @param {?} settings
         * @return {?}
         */
        TranslateService.prototype.applySettings = /**
         * @param {?} settings
         * @return {?}
         */
            function (settings) {
                var _a = this, debugMode = _a.debugMode, disableCache = _a.disableCache, supportedLangs = _a.supportedLangs, translatePaths = _a.translatePaths, translationRoot = _a.translationRoot, activeLang = _a.activeLang;
                /** @type {?} */
                var defaults = __assign({ debugMode: debugMode,
                    disableCache: disableCache,
                    supportedLangs: supportedLangs,
                    translatePaths: translatePaths,
                    translationRoot: translationRoot,
                    activeLang: activeLang }, settings);
                this.debugMode = defaults.debugMode;
                this.disableCache = defaults.disableCache;
                this.supportedLangs = defaults.supportedLangs;
                this.translatePaths = defaults.translatePaths;
                this.translationRoot = defaults.translationRoot;
                this._activeLang = defaults.activeLang || this.getBrowserLanguage();
            };
        /**
         * Get translated string
         *
         * @param key Translation key
         * @param [params] Translation parameters
         * @param [lang] Language to use for translation
         * @returns Translated string
         * @memberof TranslateService
         */
        /**
         * Get translated string
         *
         * \@memberof TranslateService
         * @param {?} key Translation key
         * @param {?=} params
         * @param {?=} lang
         * @return {?} Translated string
         */
        TranslateService.prototype.get = /**
         * Get translated string
         *
         * \@memberof TranslateService
         * @param {?} key Translation key
         * @param {?=} params
         * @param {?=} lang
         * @return {?} Translated string
         */
            function (key, params, lang) {
                if (key) {
                    /** @type {?} */
                    var value = this.getValue(lang || this.activeLang, key);
                    if (value === key) {
                        value = this.getValue(this.fallbackLang, key);
                    }
                    return this.format(value, params);
                }
                else {
                    return null;
                }
            };
        /**
         * @return {?}
         */
        TranslateService.prototype.load = /**
         * @return {?}
         */
            function () {
                return __awaiter(this, void 0, void 0, function () {
                    return __generator(this, function (_a) {
                        switch (_a.label) {
                            case 0: return [4 /*yield*/, this.use(this.fallbackLang)];
                            case 1:
                                _a.sent();
                                return [2 /*return*/, this.use(this.activeLang)];
                        }
                    });
                });
            };
        /**
         * Load the translation file or use provided data for the given language.
         *
         * @param lang Language name
         * @param [data] Translation data to use
         * @returns Final translation data merged with existing translations
         * @memberof TranslateService
         */
        /**
         * Load the translation file or use provided data for the given language.
         *
         * \@memberof TranslateService
         * @param {?} lang Language name
         * @param {?=} data
         * @return {?} Final translation data merged with existing translations
         */
        TranslateService.prototype.use = /**
         * Load the translation file or use provided data for the given language.
         *
         * \@memberof TranslateService
         * @param {?} lang Language name
         * @param {?=} data
         * @return {?} Final translation data merged with existing translations
         */
            function (lang, data) {
                return __awaiter(this, void 0, void 0, function () {
                    var e_1, _a, translation, fileName, filePaths, filePaths_1, filePaths_1_1, path, filePath, e_1_1;
                    return __generator(this, function (_b) {
                        switch (_b.label) {
                            case 0:
                                if (lang && data) {
                                    return [2 /*return*/, this.setTranslation(lang, data)];
                                }
                                translation = this.data[lang];
                                if (this.isNotSupported(lang)) {
                                    translation = this.data[this.fallbackLang];
                                }
                                if (translation && Object.keys(translation).length > 0) {
                                    return [2 /*return*/, translation];
                                }
                                fileName = (lang || this.fallbackLang) + ".json";
                                filePaths = __spread([this.translationRoot], (this.translatePaths || []));
                                _b.label = 1;
                            case 1:
                                _b.trys.push([1, 6, 7, 8]);
                                filePaths_1 = __values(filePaths), filePaths_1_1 = filePaths_1.next();
                                _b.label = 2;
                            case 2:
                                if (!!filePaths_1_1.done)
                                    return [3 /*break*/, 5];
                                path = filePaths_1_1.value;
                                filePath = path + "/" + fileName;
                                return [4 /*yield*/, this.loadTranslation(lang, filePath)];
                            case 3:
                                _b.sent();
                                _b.label = 4;
                            case 4:
                                filePaths_1_1 = filePaths_1.next();
                                return [3 /*break*/, 2];
                            case 5: return [3 /*break*/, 8];
                            case 6:
                                e_1_1 = _b.sent();
                                e_1 = { error: e_1_1 };
                                return [3 /*break*/, 8];
                            case 7:
                                try {
                                    if (filePaths_1_1 && !filePaths_1_1.done && (_a = filePaths_1.return))
                                        _a.call(filePaths_1);
                                }
                                finally {
                                    if (e_1)
                                        throw e_1.error;
                                }
                                return [7 /*endfinally*/];
                            case 8: return [2 /*return*/, this.data[lang] || {}];
                        }
                    });
                });
            };
        /**
         * @param {?} lang
         * @param {?} path
         * @return {?}
         */
        TranslateService.prototype.loadTranslation = /**
         * @param {?} lang
         * @param {?} path
         * @return {?}
         */
            function (lang, path) {
                var _this = this;
                return new Promise(function (resolve) {
                    if (_this.disableCache) {
                        path += "?v=" + Date.now();
                    }
                    _this.http.get(path).subscribe(function (json) {
                        resolve(_this.setTranslation(lang, json));
                    }, function () {
                        resolve(_this.data[lang] || {});
                    });
                });
            };
        /**
         * @param {?} lang
         * @return {?}
         */
        TranslateService.prototype.isNotSupported = /**
         * @param {?} lang
         * @return {?}
         */
            function (lang) {
                return (lang !== this.fallbackLang &&
                    lang !== this.activeLang &&
                    (this.supportedLangs &&
                        this.supportedLangs.length > 0 &&
                        !this.supportedLangs.includes(lang)));
            };
        /**
         * @param {?} lang
         * @param {?} key
         * @return {?}
         */
        TranslateService.prototype.getValue = /**
         * @param {?} lang
         * @param {?} key
         * @return {?}
         */
            function (lang, key) {
                /** @type {?} */
                var data = this.data[lang];
                if (this.isNotSupported(lang)) {
                    data = this.data[this.fallbackLang];
                }
                if (!data) {
                    return key;
                }
                /** @type {?} */
                var keys = key.split('.');
                /** @type {?} */
                var propKey = '';
                do {
                    propKey += keys.shift();
                    /** @type {?} */
                    var value = data[propKey];
                    if (value !== undefined && (typeof value === 'object' || !keys.length)) {
                        data = value;
                        propKey = '';
                    }
                    else if (!keys.length) {
                        data = key;
                    }
                    else {
                        propKey += '.';
                    }
                } while (keys.length);
                return data;
            };
        /**
         * @param {?} lang
         * @param {?} data
         * @return {?}
         */
        TranslateService.prototype.setTranslation = /**
         * @param {?} lang
         * @param {?} data
         * @return {?}
         */
            function (lang, data) {
                /** @type {?} */
                var finalResult = this.data[lang] || {};
                finalResult = this.merge(finalResult, data || {});
                this.data[lang] = finalResult;
                return finalResult;
            };
        /**
         * @param {...?} translations
         * @return {?}
         */
        TranslateService.prototype.merge = /**
         * @param {...?} translations
         * @return {?}
         */
            function () {
                var _this = this;
                var translations = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    translations[_i] = arguments[_i];
                }
                /** @type {?} */
                var result = {};
                translations.forEach(function (translation) {
                    Object.keys(translation).forEach(function (key) {
                        if (key in result && Array.isArray(result[key])) {
                            result[key] = result[key].concat(translation[key]);
                        }
                        else if (key in result && typeof result[key] === 'object') {
                            result[key] = _this.merge(result[key], translation[key]);
                        }
                        else {
                            result[key] = translation[key];
                        }
                    });
                });
                return result;
            };
        /**
         * @param {?} str
         * @param {?} params
         * @return {?}
         */
        TranslateService.prototype.format = /**
         * @param {?} str
         * @param {?} params
         * @return {?}
         */
            function (str, params) {
                /** @type {?} */
                var result = str;
                if (params) {
                    Object.keys(params).forEach(function (key) {
                        /** @type {?} */
                        var value = params[key];
                        /** @type {?} */
                        var template = new RegExp('{' + key + '}', 'gm');
                        result = result.replace(template, value);
                    });
                }
                if (this.debugMode) {
                    result = "[" + this.activeLang + "] " + result;
                }
                return result;
            };
        TranslateService.decorators = [
            { type: i0.Injectable, args: [{
                        providedIn: 'root'
                    },] }
        ];
        /** @nocollapse */
        TranslateService.ctorParameters = function () {
            return [
                { type: i1.HttpClient },
                { type: undefined, decorators: [{ type: i0.Optional }, { type: i0.Inject, args: [TRANSLATE_SETTINGS,] }] }
            ];
        };
        /** @nocollapse */ TranslateService.ngInjectableDef = i0.defineInjectable({ factory: function TranslateService_Factory() { return new TranslateService(i0.inject(i1.HttpClient), i0.inject(TRANSLATE_SETTINGS, 8)); }, token: TranslateService, providedIn: "root" });
        return TranslateService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var TitleService = /** @class */ (function () {
        function TitleService(title, translate) {
            var _this = this;
            this.title = title;
            this.translate = translate;
            this._titleKey = '';
            this.changed = new rxjs.Subject();
            translate.activeLangChanged.subscribe(function () { return _this.onLanguageChanged(); });
        }
        /**
         * @return {?}
         */
        TitleService.prototype.getTitle = /**
         * @return {?}
         */
            function () {
                return this._titleKey;
            };
        /**
         * @param {?} key
         * @return {?}
         */
        TitleService.prototype.setTitle = /**
         * @param {?} key
         * @return {?}
         */
            function (key) {
                /** @type {?} */
                var previousValue = this._titleKey;
                /** @type {?} */
                var newValue = key || '';
                /** @type {?} */
                var changed = newValue !== previousValue;
                if (changed) {
                    this._titleKey = newValue;
                    /** @type {?} */
                    var translated = this.translate.get(newValue);
                    this.title.setTitle(translated);
                    this.changed.next({
                        previousValue: previousValue,
                        currentValue: newValue
                    });
                }
            };
        /**
         * @return {?}
         */
        TitleService.prototype.onLanguageChanged = /**
         * @return {?}
         */
            function () {
                if (this._titleKey) {
                    /** @type {?} */
                    var translated = this.translate.get(this._titleKey);
                    this.title.setTitle(translated);
                }
            };
        TitleService.decorators = [
            { type: i0.Injectable, args: [{
                        providedIn: 'root'
                    },] }
        ];
        /** @nocollapse */
        TitleService.ctorParameters = function () {
            return [
                { type: i1$1.Title },
                { type: TranslateService }
            ];
        };
        /** @nocollapse */ TitleService.ngInjectableDef = i0.defineInjectable({ factory: function TitleService_Factory() { return new TitleService(i0.inject(i1$1.Title), i0.inject(TranslateService)); }, token: TitleService, providedIn: "root" });
        return TitleService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var TranslatePipe = /** @class */ (function () {
        function TranslatePipe(translate) {
            this.translate = translate;
        }
        /**
         * @param {?} key
         * @param {?=} params
         * @return {?}
         */
        TranslatePipe.prototype.transform = /**
         * @param {?} key
         * @param {?=} params
         * @return {?}
         */
            function (key, params) {
                return this.translate.get(key, params);
            };
        TranslatePipe.decorators = [
            { type: i0.Pipe, args: [{
                        name: 'translate',
                        pure: false
                    },] }
        ];
        /** @nocollapse */
        TranslatePipe.ctorParameters = function () {
            return [
                { type: TranslateService }
            ];
        };
        return TranslatePipe;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var TranslateModule = /** @class */ (function () {
        function TranslateModule() {
        }
        /**
         * @param {?=} settings
         * @return {?}
         */
        TranslateModule.forRoot = /**
         * @param {?=} settings
         * @return {?}
         */
            function (settings) {
                return {
                    ngModule: TranslateModule,
                    providers: [
                        { provide: TRANSLATE_SETTINGS, useValue: settings },
                        TranslateService,
                        TitleService
                    ]
                };
            };
        /**
         * @return {?}
         */
        TranslateModule.forChild = /**
         * @return {?}
         */
            function () {
                return {
                    ngModule: TranslateModule
                };
            };
        TranslateModule.decorators = [
            { type: i0.NgModule, args: [{
                        imports: [common.CommonModule, i1.HttpClientModule],
                        declarations: [TranslatePipe],
                        exports: [TranslatePipe]
                    },] }
        ];
        return TranslateModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    exports.TRANSLATE_SETTINGS = TRANSLATE_SETTINGS;
    exports.TranslateService = TranslateService;
    exports.TitleService = TitleService;
    exports.TranslatePipe = TranslatePipe;
    exports.TranslateModule = TranslateModule;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmdzdGFjay10cmFuc2xhdGUudW1kLmpzLm1hcCIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsIm5nOi8vQG5nc3RhY2svdHJhbnNsYXRlL2xpYi90cmFuc2xhdGUuc2VydmljZS50cyIsIm5nOi8vQG5nc3RhY2svdHJhbnNsYXRlL2xpYi90aXRsZS5zZXJ2aWNlLnRzIiwibmc6Ly9AbmdzdGFjay90cmFuc2xhdGUvbGliL3RyYW5zbGF0ZS5waXBlLnRzIiwibmc6Ly9AbmdzdGFjay90cmFuc2xhdGUvbGliL3RyYW5zbGF0ZS5tb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCJpbXBvcnQge1xuICBJbmplY3RhYmxlLFxuICBFdmVudEVtaXR0ZXIsXG4gIEluamVjdCxcbiAgSW5qZWN0aW9uVG9rZW4sXG4gIE9wdGlvbmFsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IFRyYW5zbGF0ZVNldHRpbmdzIH0gZnJvbSAnLi90cmFuc2xhdGUuc2V0dGluZ3MnO1xuXG5leHBvcnQgY29uc3QgVFJBTlNMQVRFX1NFVFRJTkdTID0gbmV3IEluamVjdGlvblRva2VuPFRyYW5zbGF0ZVNldHRpbmdzPihcbiAgJ1RSQU5TTEFURV9TRVRUSU5HUydcbik7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHJhbnNsYXRlUGFyYW1zIHtcbiAgW2tleTogc3RyaW5nXTogc3RyaW5nO1xufVxuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGVTZXJ2aWNlIHtcbiAgcHJvdGVjdGVkIGRhdGE6IHsgW2tleTogc3RyaW5nXTogYW55IH0gPSB7fTtcbiAgcHJpdmF0ZSBfZmFsbGJhY2tMYW5nID0gJ2VuJztcbiAgcHJpdmF0ZSBfYWN0aXZlTGFuZztcbiAgcHJpdmF0ZSBfdHJhbnNsYXRpb25Sb290ID0gJ2Fzc2V0cy9pMThuJztcblxuICAvKipcbiAgICogUmFpc2VkIGVhY2ggdGltZSBhY3RpdmUgbGFuZ3VhZ2UgZ2V0cyBjaGFuZ2VkLlxuICAgKi9cbiAgYWN0aXZlTGFuZ0NoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyPHtcbiAgICBwcmV2aW91c1ZhbHVlOiBzdHJpbmc7XG4gICAgY3VycmVudFZhbHVlOiBzdHJpbmc7XG4gIH0+KCk7XG5cbiAgLyoqXG4gICAqIFRvZ2dsZXMgZGVidWcgbW9kZS5cbiAgICpcbiAgICogV2hlbiBpbiB0aGUgZGVidWcgbW9kZSwgdGhlIHNlcnZpY2UgYXV0b21hdGljYWxseSBwcmVwZW5kcyBhY3RpdmUgbGFuZ3VhZ2UgaWQgdG8gdmVyeSB0cmFuc2xhdGVkIHJlc3VsdC5cbiAgICogVGhhdCBhbGxvd3MgdG8gdmVyaWZ5IHRoYXQgeW91ciBjb21wb25lbnRzIHN1cHBvcnQgaTE4biBjb3JyZWN0bHkgYW5kIGRvIG5vdCBjb250YWluIGhhcmQtY29kZWQgdGV4dC5cbiAgICovXG4gIGRlYnVnTW9kZSA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBEaXNhYmxlIGNhY2hpbmcgYW5kIGFsd2F5cyBkb3dubG9hZCBsYW5ndWFnZSBmaWxlcy5cbiAgICpcbiAgICogQXBwbGllcyBjYWNoZSBidXN0aW5nIHF1ZXJ5IHBhcmFtZXRlcnMgdG8gdXJscywgZm9yIGV4YW1wbGU6ICc/dj0xNTIyNDI2OTU1ODgyJy5cbiAgICovXG4gIGRpc2FibGVDYWNoZSA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBMaXN0IG9mIHN1cHBvcnRlZCBsYW5ndWFnZXMuXG4gICAqXG4gICAqIFRoZSBzZXJ2aWNlIHdpbGwgYXR0ZW1wdCB0byBsb2FkIHJlc291cmNlIGZpbGVzIG9ubHkgZm9yIGdpdmVuIHNldCBvZiBsYW5ndWFnZXMsXG4gICAqIGFuZCB3aWxsIGF1dG9tYXRpY2FsbHkgdXNlIGZhbGxiYWNrIGxhbmd1YWdlIGZvciBhbGwgdW5zcGVjaWZpZWQgdmFsdWVzLlxuICAgKlxuICAgKiBCeSBkZWZhdWx0IHRoaXMgcHJvcGVydHkgaXMgZW1wdHkgYW5kIHNlcnZpY2UgaXMgZ29pbmcgdG8gcHJvYmUgYWxsIGxhbmd1YWdlIGZpbGVzLlxuICAgKiBBY3RpdmUgYW5kIEZhbGxiYWNrIGxhbmd1YWdlcyBhcmUgYWx3YXlzIHRha2VuIGludG8gYWNjb3VudCBldmVuIGlmIHlvdSBkbyBub3Qgc3BlY2lmeSB0aGVtIGluIHRoZSBsaXN0LlxuICAgKi9cbiAgc3VwcG9ydGVkTGFuZ3M6IHN0cmluZ1tdID0gW107XG5cbiAgLyoqXG4gICAqIExpc3Qgb2YgZXh0cmEgcGF0aHMgdG8gbG9vayBmb3IgdHJhbnNsYXRpb24gZmlsZXMuXG4gICAqXG4gICAqIEJ5IGRlZmF1bHQgdGhpcyBwcm9wZXJ0eSBpcyBlbXB0eS5cbiAgICogVGhlIHZhbHVlIG9mIGB0cmFuc2xhdGlvblJvb3RgIHByb3BlcnR5IGlzIGFsd2F5cyB0YWtlbiBpbnRvIGFjY291bnQuXG4gICAqL1xuICB0cmFuc2xhdGVQYXRoczogc3RyaW5nW10gPSBbXTtcblxuICAvKipcbiAgICogVGhlIGZhbGxiYWNrIGxhbmd1YWdlIHRvIHVzZSB3aGVuIGEgcmVzb3VyY2Ugc3RyaW5nIGZvciB0aGUgYWN0aXZlIGxhbmd1YWdlIGlzIG5vdCBhdmFpbGFibGUuXG4gICAqL1xuICBnZXQgZmFsbGJhY2tMYW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX2ZhbGxiYWNrTGFuZztcbiAgfVxuXG4gIHNldCBmYWxsYmFja0xhbmcodmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuX2ZhbGxiYWNrTGFuZyA9IHZhbHVlIHx8ICdlbic7XG4gIH1cblxuICAvKipcbiAgICogVGhlIGxhbmd1YWdlIHRvIHVzZSBmb3IgdGhlIHRyYW5zbGF0aW9ucy5cbiAgICovXG4gIGdldCBhY3RpdmVMYW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX2FjdGl2ZUxhbmc7XG4gIH1cblxuICBzZXQgYWN0aXZlTGFuZyh2YWx1ZTogc3RyaW5nKSB7XG4gICAgY29uc3QgcHJldmlvdXNWYWx1ZSA9IHRoaXMuX2FjdGl2ZUxhbmc7XG4gICAgY29uc3QgbmV3VmFsdWUgPSB2YWx1ZSB8fCB0aGlzLmZhbGxiYWNrTGFuZztcbiAgICBjb25zdCBjaGFuZ2VkID0gbmV3VmFsdWUgIT09IHByZXZpb3VzVmFsdWU7XG5cbiAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgdGhpcy5fYWN0aXZlTGFuZyA9IG5ld1ZhbHVlO1xuICAgICAgdGhpcy51c2UobmV3VmFsdWUpLnRoZW4oKCkgPT4ge1xuICAgICAgICB0aGlzLmFjdGl2ZUxhbmdDaGFuZ2VkLm5leHQoe1xuICAgICAgICAgIHByZXZpb3VzVmFsdWU6IHByZXZpb3VzVmFsdWUsXG4gICAgICAgICAgY3VycmVudFZhbHVlOiBuZXdWYWx1ZVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGdldEJyb3dzZXJMYW5ndWFnZSgpOiBzdHJpbmcge1xuICAgIGNvbnN0IFtsYW5nIC8qLCBsb2NhbGUqL10gPSBuYXZpZ2F0b3IubGFuZ3VhZ2VcbiAgICAgIC5yZXBsYWNlKCctJywgJ18nKVxuICAgICAgLnRvTG93ZXJDYXNlKClcbiAgICAgIC5zcGxpdCgnXycpO1xuICAgIHJldHVybiBsYW5nO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSByb290IHBhdGggdG8gdXNlIHdoZW4gbG9hZGluZyBkZWZhdWx0IHRyYW5zbGF0aW9uIGZpbGVzLlxuICAgKiBEZWZhdWx0cyB0byAnYXNzZXRzL2kxOG4nLlxuICAgKi9cbiAgZ2V0IHRyYW5zbGF0aW9uUm9vdCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl90cmFuc2xhdGlvblJvb3Q7XG4gIH1cblxuICBzZXQgdHJhbnNsYXRpb25Sb290KHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLl90cmFuc2xhdGlvblJvb3QgPSB2YWx1ZSB8fCAnYXNzZXRzL2kxOG4nO1xuICB9XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50LFxuICAgIEBPcHRpb25hbCgpXG4gICAgQEluamVjdChUUkFOU0xBVEVfU0VUVElOR1MpXG4gICAgc2V0dGluZ3M6IFRyYW5zbGF0ZVNldHRpbmdzXG4gICkge1xuICAgIHRoaXMuYXBwbHlTZXR0aW5ncyhzZXR0aW5ncyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgYXBwbHlTZXR0aW5ncyhzZXR0aW5nczogVHJhbnNsYXRlU2V0dGluZ3MpIHtcbiAgICBjb25zdCB7XG4gICAgICBkZWJ1Z01vZGUsXG4gICAgICBkaXNhYmxlQ2FjaGUsXG4gICAgICBzdXBwb3J0ZWRMYW5ncyxcbiAgICAgIHRyYW5zbGF0ZVBhdGhzLFxuICAgICAgdHJhbnNsYXRpb25Sb290LFxuICAgICAgYWN0aXZlTGFuZ1xuICAgIH0gPSB0aGlzO1xuXG4gICAgY29uc3QgZGVmYXVsdHMgPSB7XG4gICAgICBkZWJ1Z01vZGUsXG4gICAgICBkaXNhYmxlQ2FjaGUsXG4gICAgICBzdXBwb3J0ZWRMYW5ncyxcbiAgICAgIHRyYW5zbGF0ZVBhdGhzLFxuICAgICAgdHJhbnNsYXRpb25Sb290LFxuICAgICAgYWN0aXZlTGFuZyxcbiAgICAgIC4uLnNldHRpbmdzXG4gICAgfTtcblxuICAgIHRoaXMuZGVidWdNb2RlID0gZGVmYXVsdHMuZGVidWdNb2RlO1xuICAgIHRoaXMuZGlzYWJsZUNhY2hlID0gZGVmYXVsdHMuZGlzYWJsZUNhY2hlO1xuICAgIHRoaXMuc3VwcG9ydGVkTGFuZ3MgPSBkZWZhdWx0cy5zdXBwb3J0ZWRMYW5ncztcbiAgICB0aGlzLnRyYW5zbGF0ZVBhdGhzID0gZGVmYXVsdHMudHJhbnNsYXRlUGF0aHM7XG4gICAgdGhpcy50cmFuc2xhdGlvblJvb3QgPSBkZWZhdWx0cy50cmFuc2xhdGlvblJvb3Q7XG4gICAgdGhpcy5fYWN0aXZlTGFuZyA9IGRlZmF1bHRzLmFjdGl2ZUxhbmcgfHwgdGhpcy5nZXRCcm93c2VyTGFuZ3VhZ2UoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdHJhbnNsYXRlZCBzdHJpbmdcbiAgICpcbiAgICogQHBhcmFtIGtleSBUcmFuc2xhdGlvbiBrZXlcbiAgICogQHBhcmFtIFtwYXJhbXNdIFRyYW5zbGF0aW9uIHBhcmFtZXRlcnNcbiAgICogQHBhcmFtIFtsYW5nXSBMYW5ndWFnZSB0byB1c2UgZm9yIHRyYW5zbGF0aW9uXG4gICAqIEByZXR1cm5zIFRyYW5zbGF0ZWQgc3RyaW5nXG4gICAqIEBtZW1iZXJvZiBUcmFuc2xhdGVTZXJ2aWNlXG4gICAqL1xuICBnZXQoa2V5OiBzdHJpbmcsIHBhcmFtcz86IFRyYW5zbGF0ZVBhcmFtcywgbGFuZz86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKGtleSkge1xuICAgICAgbGV0IHZhbHVlID0gdGhpcy5nZXRWYWx1ZShsYW5nIHx8IHRoaXMuYWN0aXZlTGFuZywga2V5KTtcbiAgICAgIGlmICh2YWx1ZSA9PT0ga2V5KSB7XG4gICAgICAgIHZhbHVlID0gdGhpcy5nZXRWYWx1ZSh0aGlzLmZhbGxiYWNrTGFuZywga2V5KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmZvcm1hdCh2YWx1ZSwgcGFyYW1zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbG9hZCgpOiBQcm9taXNlPGFueT4ge1xuICAgIGF3YWl0IHRoaXMudXNlKHRoaXMuZmFsbGJhY2tMYW5nKTtcbiAgICByZXR1cm4gdGhpcy51c2UodGhpcy5hY3RpdmVMYW5nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2FkIHRoZSB0cmFuc2xhdGlvbiBmaWxlIG9yIHVzZSBwcm92aWRlZCBkYXRhIGZvciB0aGUgZ2l2ZW4gbGFuZ3VhZ2UuXG4gICAqXG4gICAqIEBwYXJhbSBsYW5nIExhbmd1YWdlIG5hbWVcbiAgICogQHBhcmFtIFtkYXRhXSBUcmFuc2xhdGlvbiBkYXRhIHRvIHVzZVxuICAgKiBAcmV0dXJucyBGaW5hbCB0cmFuc2xhdGlvbiBkYXRhIG1lcmdlZCB3aXRoIGV4aXN0aW5nIHRyYW5zbGF0aW9uc1xuICAgKiBAbWVtYmVyb2YgVHJhbnNsYXRlU2VydmljZVxuICAgKi9cbiAgYXN5bmMgdXNlKGxhbmc6IHN0cmluZywgZGF0YT86IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgaWYgKGxhbmcgJiYgZGF0YSkge1xuICAgICAgcmV0dXJuIHRoaXMuc2V0VHJhbnNsYXRpb24obGFuZywgZGF0YSk7XG4gICAgfVxuXG4gICAgbGV0IHRyYW5zbGF0aW9uID0gdGhpcy5kYXRhW2xhbmddO1xuICAgIGlmICh0aGlzLmlzTm90U3VwcG9ydGVkKGxhbmcpKSB7XG4gICAgICB0cmFuc2xhdGlvbiA9IHRoaXMuZGF0YVt0aGlzLmZhbGxiYWNrTGFuZ107XG4gICAgfVxuXG4gICAgaWYgKHRyYW5zbGF0aW9uICYmIE9iamVjdC5rZXlzKHRyYW5zbGF0aW9uKS5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gdHJhbnNsYXRpb247XG4gICAgfVxuXG4gICAgY29uc3QgZmlsZU5hbWUgPSBgJHtsYW5nIHx8IHRoaXMuZmFsbGJhY2tMYW5nfS5qc29uYDtcbiAgICBjb25zdCBmaWxlUGF0aHMgPSBbdGhpcy50cmFuc2xhdGlvblJvb3QsIC4uLih0aGlzLnRyYW5zbGF0ZVBhdGhzIHx8IFtdKV07XG5cbiAgICBmb3IgKGNvbnN0IHBhdGggb2YgZmlsZVBhdGhzKSB7XG4gICAgICBjb25zdCBmaWxlUGF0aCA9IGAke3BhdGh9LyR7ZmlsZU5hbWV9YDtcbiAgICAgIGF3YWl0IHRoaXMubG9hZFRyYW5zbGF0aW9uKGxhbmcsIGZpbGVQYXRoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5kYXRhW2xhbmddIHx8IHt9O1xuICB9XG5cbiAgcHJvdGVjdGVkIGxvYWRUcmFuc2xhdGlvbihsYW5nOiBzdHJpbmcsIHBhdGg6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPGFueT4ocmVzb2x2ZSA9PiB7XG4gICAgICBpZiAodGhpcy5kaXNhYmxlQ2FjaGUpIHtcbiAgICAgICAgcGF0aCArPSBgP3Y9JHtEYXRlLm5vdygpfWA7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaHR0cC5nZXQ8e30+KHBhdGgpLnN1YnNjcmliZShcbiAgICAgICAganNvbiA9PiB7XG4gICAgICAgICAgcmVzb2x2ZSh0aGlzLnNldFRyYW5zbGF0aW9uKGxhbmcsIGpzb24pKTtcbiAgICAgICAgfSxcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgIHJlc29sdmUodGhpcy5kYXRhW2xhbmddIHx8IHt9KTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBpc05vdFN1cHBvcnRlZChsYW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIChcbiAgICAgIGxhbmcgIT09IHRoaXMuZmFsbGJhY2tMYW5nICYmXG4gICAgICBsYW5nICE9PSB0aGlzLmFjdGl2ZUxhbmcgJiZcbiAgICAgICh0aGlzLnN1cHBvcnRlZExhbmdzICYmXG4gICAgICAgIHRoaXMuc3VwcG9ydGVkTGFuZ3MubGVuZ3RoID4gMCAmJlxuICAgICAgICAhdGhpcy5zdXBwb3J0ZWRMYW5ncy5pbmNsdWRlcyhsYW5nKSlcbiAgICApO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldFZhbHVlKGxhbmc6IHN0cmluZywga2V5OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGxldCBkYXRhID0gdGhpcy5kYXRhW2xhbmddO1xuICAgIGlmICh0aGlzLmlzTm90U3VwcG9ydGVkKGxhbmcpKSB7XG4gICAgICBkYXRhID0gdGhpcy5kYXRhW3RoaXMuZmFsbGJhY2tMYW5nXTtcbiAgICB9XG5cbiAgICBpZiAoIWRhdGEpIHtcbiAgICAgIHJldHVybiBrZXk7XG4gICAgfVxuXG4gICAgY29uc3Qga2V5cyA9IGtleS5zcGxpdCgnLicpO1xuICAgIGxldCBwcm9wS2V5ID0gJyc7XG5cbiAgICBkbyB7XG4gICAgICBwcm9wS2V5ICs9IGtleXMuc2hpZnQoKTtcbiAgICAgIGNvbnN0IHZhbHVlID0gZGF0YVtwcm9wS2V5XTtcbiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIHx8ICFrZXlzLmxlbmd0aCkpIHtcbiAgICAgICAgZGF0YSA9IHZhbHVlO1xuICAgICAgICBwcm9wS2V5ID0gJyc7XG4gICAgICB9IGVsc2UgaWYgKCFrZXlzLmxlbmd0aCkge1xuICAgICAgICBkYXRhID0ga2V5O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJvcEtleSArPSAnLic7XG4gICAgICB9XG4gICAgfSB3aGlsZSAoa2V5cy5sZW5ndGgpO1xuXG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cblxuICBwcm90ZWN0ZWQgc2V0VHJhbnNsYXRpb24obGFuZzogc3RyaW5nLCBkYXRhOiBhbnkpOiBhbnkge1xuICAgIGxldCBmaW5hbFJlc3VsdCA9IHRoaXMuZGF0YVtsYW5nXSB8fCB7fTtcbiAgICBmaW5hbFJlc3VsdCA9IHRoaXMubWVyZ2UoZmluYWxSZXN1bHQsIGRhdGEgfHwge30pO1xuICAgIHRoaXMuZGF0YVtsYW5nXSA9IGZpbmFsUmVzdWx0O1xuICAgIHJldHVybiBmaW5hbFJlc3VsdDtcbiAgfVxuXG4gIHByb3RlY3RlZCBtZXJnZSguLi50cmFuc2xhdGlvbnMpOiBhbnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuXG4gICAgdHJhbnNsYXRpb25zLmZvckVhY2godHJhbnNsYXRpb24gPT4ge1xuICAgICAgT2JqZWN0LmtleXModHJhbnNsYXRpb24pLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgaWYgKGtleSBpbiByZXN1bHQgJiYgQXJyYXkuaXNBcnJheShyZXN1bHRba2V5XSkpIHtcbiAgICAgICAgICByZXN1bHRba2V5XSA9IHJlc3VsdFtrZXldLmNvbmNhdCh0cmFuc2xhdGlvbltrZXldKTtcbiAgICAgICAgfSBlbHNlIGlmIChrZXkgaW4gcmVzdWx0ICYmIHR5cGVvZiByZXN1bHRba2V5XSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICByZXN1bHRba2V5XSA9IHRoaXMubWVyZ2UocmVzdWx0W2tleV0sIHRyYW5zbGF0aW9uW2tleV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3VsdFtrZXldID0gdHJhbnNsYXRpb25ba2V5XTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHJvdGVjdGVkIGZvcm1hdChzdHI6IHN0cmluZywgcGFyYW1zOiBUcmFuc2xhdGVQYXJhbXMpOiBzdHJpbmcge1xuICAgIGxldCByZXN1bHQgPSBzdHI7XG5cbiAgICBpZiAocGFyYW1zKSB7XG4gICAgICBPYmplY3Qua2V5cyhwYXJhbXMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBwYXJhbXNba2V5XTtcbiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSBuZXcgUmVnRXhwKCd7JyArIGtleSArICd9JywgJ2dtJyk7XG5cbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UodGVtcGxhdGUsIHZhbHVlKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRlYnVnTW9kZSkge1xuICAgICAgcmVzdWx0ID0gYFske3RoaXMuYWN0aXZlTGFuZ31dICR7cmVzdWx0fWA7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxufVxuIiwiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgVGl0bGUgfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcbmltcG9ydCB7IFRyYW5zbGF0ZVNlcnZpY2UgfSBmcm9tICcuL3RyYW5zbGF0ZS5zZXJ2aWNlJztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcblxuQEluamVjdGFibGUoe1xuICBwcm92aWRlZEluOiAncm9vdCdcbn0pXG5leHBvcnQgY2xhc3MgVGl0bGVTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBfdGl0bGVLZXkgPSAnJztcblxuICBjaGFuZ2VkID0gbmV3IFN1YmplY3Q8e1xuICAgIHByZXZpb3VzVmFsdWU6IHN0cmluZztcbiAgICBjdXJyZW50VmFsdWU6IHN0cmluZztcbiAgfT4oKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHRpdGxlOiBUaXRsZSwgcHJpdmF0ZSB0cmFuc2xhdGU6IFRyYW5zbGF0ZVNlcnZpY2UpIHtcbiAgICB0cmFuc2xhdGUuYWN0aXZlTGFuZ0NoYW5nZWQuc3Vic2NyaWJlKCgpID0+IHRoaXMub25MYW5ndWFnZUNoYW5nZWQoKSk7XG4gIH1cblxuICBnZXRUaXRsZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl90aXRsZUtleTtcbiAgfVxuXG4gIHNldFRpdGxlKGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgcHJldmlvdXNWYWx1ZSA9IHRoaXMuX3RpdGxlS2V5O1xuICAgIGNvbnN0IG5ld1ZhbHVlID0ga2V5IHx8ICcnO1xuICAgIGNvbnN0IGNoYW5nZWQgPSBuZXdWYWx1ZSAhPT0gcHJldmlvdXNWYWx1ZTtcblxuICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICB0aGlzLl90aXRsZUtleSA9IG5ld1ZhbHVlO1xuXG4gICAgICBjb25zdCB0cmFuc2xhdGVkID0gdGhpcy50cmFuc2xhdGUuZ2V0KG5ld1ZhbHVlKTtcbiAgICAgIHRoaXMudGl0bGUuc2V0VGl0bGUodHJhbnNsYXRlZCk7XG5cbiAgICAgIHRoaXMuY2hhbmdlZC5uZXh0KHtcbiAgICAgICAgcHJldmlvdXNWYWx1ZTogcHJldmlvdXNWYWx1ZSxcbiAgICAgICAgY3VycmVudFZhbHVlOiBuZXdWYWx1ZVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBvbkxhbmd1YWdlQ2hhbmdlZCgpIHtcbiAgICBpZiAodGhpcy5fdGl0bGVLZXkpIHtcbiAgICAgIGNvbnN0IHRyYW5zbGF0ZWQgPSB0aGlzLnRyYW5zbGF0ZS5nZXQodGhpcy5fdGl0bGVLZXkpO1xuICAgICAgdGhpcy50aXRsZS5zZXRUaXRsZSh0cmFuc2xhdGVkKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IFBpcGUsIFBpcGVUcmFuc2Zvcm0gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFRyYW5zbGF0ZVNlcnZpY2UsIFRyYW5zbGF0ZVBhcmFtcyB9IGZyb20gJy4vdHJhbnNsYXRlLnNlcnZpY2UnO1xuXG5AUGlwZSh7XG4gIG5hbWU6ICd0cmFuc2xhdGUnLFxuICBwdXJlOiBmYWxzZVxufSlcbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGVQaXBlIGltcGxlbWVudHMgUGlwZVRyYW5zZm9ybSB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgdHJhbnNsYXRlOiBUcmFuc2xhdGVTZXJ2aWNlKSB7fVxuXG4gIHRyYW5zZm9ybShrZXk6IHN0cmluZywgcGFyYW1zPzogVHJhbnNsYXRlUGFyYW1zKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy50cmFuc2xhdGUuZ2V0KGtleSwgcGFyYW1zKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgTmdNb2R1bGUsIE1vZHVsZVdpdGhQcm92aWRlcnMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBIdHRwQ2xpZW50TW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgVHJhbnNsYXRlU2VydmljZSwgVFJBTlNMQVRFX1NFVFRJTkdTIH0gZnJvbSAnLi90cmFuc2xhdGUuc2VydmljZSc7XG5pbXBvcnQgeyBUcmFuc2xhdGVQaXBlIH0gZnJvbSAnLi90cmFuc2xhdGUucGlwZSc7XG5pbXBvcnQgeyBUaXRsZVNlcnZpY2UgfSBmcm9tICcuL3RpdGxlLnNlcnZpY2UnO1xuaW1wb3J0IHsgVHJhbnNsYXRlU2V0dGluZ3MgfSBmcm9tICcuL3RyYW5zbGF0ZS5zZXR0aW5ncyc7XG5cbkBOZ01vZHVsZSh7XG4gIGltcG9ydHM6IFtDb21tb25Nb2R1bGUsIEh0dHBDbGllbnRNb2R1bGVdLFxuICBkZWNsYXJhdGlvbnM6IFtUcmFuc2xhdGVQaXBlXSxcbiAgZXhwb3J0czogW1RyYW5zbGF0ZVBpcGVdXG59KVxuZXhwb3J0IGNsYXNzIFRyYW5zbGF0ZU1vZHVsZSB7XG4gIHN0YXRpYyBmb3JSb290KHNldHRpbmdzPzogVHJhbnNsYXRlU2V0dGluZ3MpOiBNb2R1bGVXaXRoUHJvdmlkZXJzIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmdNb2R1bGU6IFRyYW5zbGF0ZU1vZHVsZSxcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICB7IHByb3ZpZGU6IFRSQU5TTEFURV9TRVRUSU5HUywgdXNlVmFsdWU6IHNldHRpbmdzIH0sXG4gICAgICAgIFRyYW5zbGF0ZVNlcnZpY2UsXG4gICAgICAgIFRpdGxlU2VydmljZVxuICAgICAgXVxuICAgIH07XG4gIH1cblxuICBzdGF0aWMgZm9yQ2hpbGQoKTogTW9kdWxlV2l0aFByb3ZpZGVycyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5nTW9kdWxlOiBUcmFuc2xhdGVNb2R1bGVcbiAgICB9O1xuICB9XG59XG4iXSwibmFtZXMiOlsiSW5qZWN0aW9uVG9rZW4iLCJFdmVudEVtaXR0ZXIiLCJ0c2xpYl8xLl9fdmFsdWVzIiwiSW5qZWN0YWJsZSIsIkh0dHBDbGllbnQiLCJPcHRpb25hbCIsIkluamVjdCIsIlN1YmplY3QiLCJUaXRsZSIsIlBpcGUiLCJOZ01vZHVsZSIsIkNvbW1vbk1vZHVsZSIsIkh0dHBDbGllbnRNb2R1bGUiXSwibWFwcGluZ3MiOiI7Ozs7OztJQUFBOzs7Ozs7Ozs7Ozs7OztBQWNBLElBZU8sSUFBSSxRQUFRLEdBQUc7UUFDbEIsUUFBUSxHQUFHLE1BQU0sQ0FBQyxNQUFNLElBQUksU0FBUyxRQUFRLENBQUMsQ0FBQztZQUMzQyxLQUFLLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDakQsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDakIsS0FBSyxJQUFJLENBQUMsSUFBSSxDQUFDO29CQUFFLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7d0JBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUNoRjtZQUNELE9BQU8sQ0FBQyxDQUFDO1NBQ1osQ0FBQTtRQUNELE9BQU8sUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDM0MsQ0FBQyxDQUFBO0FBRUQsYUF5QmdCLFNBQVMsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBRSxTQUFTO1FBQ3ZELE9BQU8sS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLE9BQU8sQ0FBQyxFQUFFLFVBQVUsT0FBTyxFQUFFLE1BQU07WUFDckQsU0FBUyxTQUFTLENBQUMsS0FBSyxJQUFJLElBQUk7Z0JBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQzthQUFFO1lBQUMsT0FBTyxDQUFDLEVBQUU7Z0JBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQUUsRUFBRTtZQUMzRixTQUFTLFFBQVEsQ0FBQyxLQUFLLElBQUksSUFBSTtnQkFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7YUFBRTtZQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUFFLEVBQUU7WUFDOUYsU0FBUyxJQUFJLENBQUMsTUFBTSxJQUFJLE1BQU0sQ0FBQyxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxVQUFVLE9BQU8sSUFBSSxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUMsRUFBRTtZQUMvSSxJQUFJLENBQUMsQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsVUFBVSxJQUFJLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7U0FDekUsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztBQUVELGFBQWdCLFdBQVcsQ0FBQyxPQUFPLEVBQUUsSUFBSTtRQUNyQyxJQUFJLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLGNBQWEsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztnQkFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDakgsT0FBTyxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLE9BQU8sTUFBTSxLQUFLLFVBQVUsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLGNBQWEsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3pKLFNBQVMsSUFBSSxDQUFDLENBQUMsSUFBSSxPQUFPLFVBQVUsQ0FBQyxJQUFJLE9BQU8sSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUU7UUFDbEUsU0FBUyxJQUFJLENBQUMsRUFBRTtZQUNaLElBQUksQ0FBQztnQkFBRSxNQUFNLElBQUksU0FBUyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7WUFDOUQsT0FBTyxDQUFDO2dCQUFFLElBQUk7b0JBQ1YsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJO3dCQUFFLE9BQU8sQ0FBQyxDQUFDO29CQUM3SixJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQzt3QkFBRSxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztvQkFDeEMsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDO3dCQUNULEtBQUssQ0FBQyxDQUFDO3dCQUFDLEtBQUssQ0FBQzs0QkFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDOzRCQUFDLE1BQU07d0JBQzlCLEtBQUssQ0FBQzs0QkFBRSxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7NEJBQUMsT0FBTyxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxDQUFDO3dCQUN4RCxLQUFLLENBQUM7NEJBQUUsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDOzRCQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQUMsU0FBUzt3QkFDakQsS0FBSyxDQUFDOzRCQUFFLEVBQUUsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDOzRCQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7NEJBQUMsU0FBUzt3QkFDakQ7NEJBQ0ksSUFBSSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO2dDQUFFLENBQUMsR0FBRyxDQUFDLENBQUM7Z0NBQUMsU0FBUzs2QkFBRTs0QkFDNUcsSUFBSSxF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