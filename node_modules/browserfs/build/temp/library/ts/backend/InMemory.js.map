{"version":3,"file":"InMemory.js","sourceRoot":"","sources":["../../../../../src/backend/InMemory.ts"],"names":[],"mappings":"AACA,OAAO,EAAqC,uBAAuB,EAA6B,sBAAsB,EAAC,MAAM,iCAAiC,CAAC;AAE/J;;GAEG;AACH,MAAM;IAAN;QACU,UAAK,GAA8B,EAAE,CAAC;IAwBhD,CAAC;IAtBQ,IAAI,KAAK,MAAM,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC,CAAC;IAC1C,KAAK,KAAK,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC,CAAC,CAAC;IAE5B,gBAAgB,CAAC,IAAY;QAClC,MAAM,CAAC,IAAI,uBAAuB,CAAC,IAAI,CAAC,CAAC;IAC3C,CAAC;IAEM,GAAG,CAAC,GAAW;QACpB,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACzB,CAAC;IAEM,GAAG,CAAC,GAAW,EAAE,IAAY,EAAE,SAAkB;QACtD,EAAE,CAAC,CAAC,CAAC,SAAS,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YACjD,MAAM,CAAC,KAAK,CAAC;QACf,CAAC;QACD,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;QACvB,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAEM,GAAG,CAAC,GAAW;QACpB,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACzB,CAAC;CACF;AAED;;;GAGG;AACH,MAAM,CAAC,OAAO,yBAA0B,SAAQ,sBAAsB;IAWpE;QACE,KAAK,CAAC,EAAE,KAAK,EAAE,IAAI,aAAa,EAAE,EAAE,CAAC,CAAC;IACxC,CAAC;IARD;;OAEG;IACI,MAAM,CAAC,MAAM,CAAC,OAAY,EAAE,EAAmC;QACpE,EAAE,CAAC,IAAI,EAAE,IAAI,kBAAkB,EAAE,CAAC,CAAC;IACrC,CAAC;;AATsB,uBAAI,GAAG,UAAU,CAAC;AAElB,0BAAO,GAAsB,EAAE,CAAC","sourcesContent":["import {BFSCallback, FileSystemOptions} from '../core/file_system';\nimport {SyncKeyValueStore, SimpleSyncStore, SimpleSyncRWTransaction, SyncKeyValueRWTransaction, SyncKeyValueFileSystem} from '../generic/key_value_filesystem';\n\n/**\n * A simple in-memory key-value store backed by a JavaScript object.\n */\nexport class InMemoryStore implements SyncKeyValueStore, SimpleSyncStore {\n  private store: { [key: string]: Buffer } = {};\n\n  public name() { return InMemoryFileSystem.Name; }\n  public clear() { this.store = {}; }\n\n  public beginTransaction(type: string): SyncKeyValueRWTransaction {\n    return new SimpleSyncRWTransaction(this);\n  }\n\n  public get(key: string): Buffer {\n    return this.store[key];\n  }\n\n  public put(key: string, data: Buffer, overwrite: boolean): boolean {\n    if (!overwrite && this.store.hasOwnProperty(key)) {\n      return false;\n    }\n    this.store[key] = data;\n    return true;\n  }\n\n  public del(key: string): void {\n    delete this.store[key];\n  }\n}\n\n/**\n * A simple in-memory file system backed by an InMemoryStore.\n * Files are not persisted across page loads.\n */\nexport default class InMemoryFileSystem extends SyncKeyValueFileSystem {\n  public static readonly Name = \"InMemory\";\n\n  public static readonly Options: FileSystemOptions = {};\n\n  /**\n   * Creates an InMemoryFileSystem instance.\n   */\n  public static Create(options: any, cb: BFSCallback<InMemoryFileSystem>): void {\n    cb(null, new InMemoryFileSystem());\n  }\n  constructor() {\n    super({ store: new InMemoryStore() });\n  }\n}\n"]}